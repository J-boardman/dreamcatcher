import{s as O,a as T,c as A,i as p,d as m,w as E,o as j,b as I,f as U,l as _,g as S,h as C,m as d,j as w,n as v,B as L,S as q,A as D}from"../chunks/scheduler.3b07f987.js";import{S as J,i as M,b as $,d as y,m as b,a as h,t as g,e as k,g as z,c as G}from"../chunks/index.c72e2f07.js";import{e as F}from"../chunks/Title.49fc599e.js";import{g as H}from"../chunks/navigation.c51359bf.js";import{p as K}from"../chunks/stores.2d407fbe.js";import{P as Q,a as R}from"../chunks/ProfileBottomNavigation.4d38b86a.js";import{S as V}from"../chunks/StoryCard.6cd06b38.js";import{p as W,h as X}from"../chunks/stores.b4316504.js";import{c as Y}from"../chunks/index.b07aa697.js";function B(s,t,l){const n=s.slice();return n[8]=t[l],n}function P(s){let t,l,n,u,o;return l=new V({props:{story:s[8],hideAuthorCard:s[3]!="liked"}}),{c(){t=U("a"),$(l.$$.fragment),n=T(),this.h()},l(e){t=S(e,"A",{href:!0});var a=C(t);y(l.$$.fragment,a),n=A(a),a.forEach(m),this.h()},h(){w(t,"href",u="/story/"+s[8].id)},m(e,a){p(e,t,a),b(l,t,null),D(t,n),o=!0},p(e,a){const r={};a&1&&(r.story=e[8]),a&8&&(r.hideAuthorCard=e[3]!="liked"),l.$set(r),(!o||a&1&&u!==(u="/story/"+e[8].id))&&w(t,"href",u)},i(e){o||(h(l.$$.fragment,e),o=!0)},o(e){g(l.$$.fragment,e),o=!1},d(e){e&&m(t),k(l)}}}function Z(s){let t,l,n,u,o=F(s[0].stories),e=[];for(let r=0;r<o.length;r+=1)e[r]=P(B(s,o,r));const a=r=>g(e[r],1,1,()=>{e[r]=null});return{c(){t=U("section");for(let r=0;r<e.length;r+=1)e[r].c();l=_(`
	Followers: `),n=_(s[2]),this.h()},l(r){t=S(r,"SECTION",{class:!0});var i=C(t);for(let f=0;f<e.length;f+=1)e[f].l(i);i.forEach(m),l=d(r,`
	Followers: `),n=d(r,s[2]),this.h()},h(){w(t,"class","grid gap-4 md:grid-cols-2 lg:grid-cols-3")},m(r,i){p(r,t,i);for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(t,null);p(r,l,i),p(r,n,i),u=!0},p(r,i){if(i&9){o=F(r[0].stories);let f;for(f=0;f<o.length;f+=1){const c=B(r,o,f);e[f]?(e[f].p(c,i),h(e[f],1)):(e[f]=P(c),e[f].c(),h(e[f],1),e[f].m(t,null))}for(z(),f=o.length;f<e.length;f+=1)a(f);G()}(!u||i&4)&&v(n,r[2])},i(r){if(!u){for(let i=0;i<o.length;i+=1)h(e[i]);u=!0}},o(r){e=e.filter(Boolean);for(let i=0;i<e.length;i+=1)g(e[i]);u=!1},d(r){r&&(m(t),m(l),m(n)),L(e,r)}}}function x(s){let t;return{c(){t=_("Follow")},l(l){t=d(l,"Follow")},m(l,n){p(l,t,n)},d(l){l&&m(t)}}}function ee(s){let t;return{c(){t=_("Following")},l(l){t=d(l,"Following")},m(l,n){p(l,t,n)},d(l){l&&m(t)}}}function te(s){let t,l,n;function u(a,r){return a[1]?ee:x}let o=u(s),e=o(s);return{c(){t=U("button"),e.c(),this.h()},l(a){t=S(a,"BUTTON",{class:!0});var r=C(t);e.l(r),r.forEach(m),this.h()},h(){w(t,"class","btn join-item h-full")},m(a,r){p(a,t,r),e.m(t,null),l||(n=q(t,"click",s[4]),l=!0)},p(a,r){o!==(o=u(a))&&(e.d(1),e=o(a),e&&(e.c(),e.m(t,null)))},d(a){a&&m(t),e.d(),l=!1,n()}}}function oe(s){let t,l,n,u;return t=new Q({props:{user:{username:s[0].username,imageUrl:s[0].imageUrl},$$slots:{default:[Z]},$$scope:{ctx:s}}}),n=new R({props:{$$slots:{default:[te]},$$scope:{ctx:s}}}),{c(){$(t.$$.fragment),l=T(),$(n.$$.fragment)},l(o){y(t.$$.fragment,o),l=A(o),y(n.$$.fragment,o)},m(o,e){b(t,o,e),p(o,l,e),b(n,o,e),u=!0},p(o,[e]){const a={};e&1&&(a.user={username:o[0].username,imageUrl:o[0].imageUrl}),e&2061&&(a.$$scope={dirty:e,ctx:o}),t.$set(a);const r={};e&2050&&(r.$$scope={dirty:e,ctx:o}),n.$set(r)},i(o){u||(h(t.$$.fragment,o),h(n.$$.fragment,o),u=!0)},o(o){g(t.$$.fragment,o),g(n.$$.fragment,o),u=!1},d(o){o&&m(l),k(t,o),k(n,o)}}}function re(s,t,l){let n,u,o,e,a,r;E(s,Y,c=>l(5,a=c)),E(s,K,c=>l(6,r=c));let{data:i}=t;j(()=>{W.set(`${i.username}'s profile`),X.set({src:i.imageUrl,rounded:!0})}),I(()=>{n==i.id&&H("/profile",{replaceState:!0})});async function f(){var c;await fetch("/api/following",{method:o?"DELETE":"POST",body:JSON.stringify({follower:(c=a==null?void 0:a.user)==null?void 0:c.id,following:i.id})}),l(2,u=await fetch(`/api/following/${i.id}`).then(N=>N.json())),l(1,o=!o)}return s.$$set=c=>{"data"in c&&l(0,i=c.data)},s.$$.update=()=>{var c;s.$$.dirty&32&&(n=(c=a==null?void 0:a.user)==null?void 0:c.id),s.$$.dirty&1&&l(2,u=i.followerCount),s.$$.dirty&1&&l(1,o=i.followedByUser),s.$$.dirty&64&&l(3,e=r.url.searchParams.get("filter"))},[i,o,u,e,f,a,r]}class pe extends J{constructor(t){super(),M(this,t,re,oe,O,{data:0})}}export{pe as component};
