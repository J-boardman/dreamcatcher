import{E as o}from"./scheduler.24c66ff4.js";import{j as a}from"./stores.745d342d.js";import{p as i}from"./stores.18c5f3a7.js";import{b as d}from"./index.6dac0e4f.js";import{g as f}from"./navigation.ce6aac00.js";function l(e,t){const n={id:t||d(),lastState:"INTERPRETING",created:new Date,lastUpdated:new Date,messageList:[{role:"system",name:"hidden message",id:"00",content:""}],name:e||"Dream Journal",story:{title:"",story:"Story Type",mood:"",setting:"",type:"",chapterIndexStart:0},image:{url:"",created:""},finalImageUrl:""};return p(n),n}function g(){var n;const e=(n=o(i).data)==null?void 0:n.id,t=s();return t==null?void 0:t.find(r=>r.id==e)}function N(){var t;const e=g();if(e)a.set(e),J();else{const n=l("My dream Journal",(t=o(i).data)==null?void 0:t.id);a.set(n),u()}}function m(e){a.update(t=>({...t,...e})),u()}function h(e){let t=e||o(a).id;const n=s();if(!localStorage||!(n!=null&&n.length)||!t)return;const r=n.filter(c=>c.id!=t);localStorage.setItem("journals",JSON.stringify(r))}function u(){const e=s();if(!localStorage||!e)return;const t=e==null?void 0:e.map(n=>n.id==o(a).id?o(a):n);localStorage.setItem("journals",JSON.stringify(t))}function p(e){const t=s();if(!localStorage)return;const n=t!=null&&t.length?[...t,e]:[e];localStorage.setItem("journals",JSON.stringify(n))}function s(){if(localStorage)return JSON.parse(localStorage.getItem("journals")||"[]")}function J(){const e=o(a).messageList.filter(t=>!(t.name=="Cover Image update"||!t.content));m({messageList:e})}function C(e){const t=s();if(!localStorage||!t)return;const n=t==null?void 0:t.map(r=>r.id==o(a).id?{...o(a),id:e}:r);localStorage.setItem("journals",JSON.stringify(n))}function D(){const e=l();f(`/journal/${e.id}`)}export{N as a,l as c,D as h,h as r,C as s,m as u};
